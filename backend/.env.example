# APH-IF Backend Environment Configuration Template
# Copy this file to .env and update with your actual values
# DO NOT COMMIT THE REAL .env FILE - Contains sensitive API keys

# ============================================================================
# CRITICAL CONFIGURATION (REQUIRED)
# ============================================================================
# These must be set for the application to function

# Neo4j Database Configuration
NEO4J_URI=neo4j+s://your-instance.databases.neo4j.io
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=your-password-here
NEO4J_DATABASE=neo4j

# OpenAI API Configuration  
OPENAI_API_KEY=sk-your-api-key-here
OPENAI_MODEL_MINI=gpt-5-mini

# ============================================================================
# ENVIRONMENT CONFIGURATION
# ============================================================================
# Controls which Neo4j instance is used automatically:
# - development: Safe for development work
# - production:  Live data - use with extreme caution
# - testing:     Explicit test database (use FORCE_TEST_DB=true)

APP_ENV=development
FORCE_TEST_DB=false

# Debug and Logging
VERBOSE=true
DEBUG=true

# Service Configuration
HOST=127.0.0.1
PORT=8000
BACKEND_URL=http://localhost:8000
DATA_PROCESSING_URL=http://localhost:8010
FRONTEND_URL=http://localhost:8501

# ============================================================================
# OPENAI API CONFIGURATION
# ============================================================================

# Rate Limiting Configuration (Adjust based on your OpenAI tier)
OPENAI_REQUESTS_PER_MINUTE=4500
OPENAI_TOKENS_PER_MINUTE=3600000
OPENAI_MAX_TOKENS=6000
OPENAI_TEMPERATURE=1.0

# Embedding Configuration
OPENAI_EMBEDDING_MODEL=text-embedding-3-large
OPENAI_EMBEDDING_DIMENSIONS=3072

# ============================================================================
# LLM CLIENT CONFIGURATION
# ============================================================================

LLM_TIMEOUT_SECONDS=240
LLM_MAX_RETRIES=3
LLM_RATE_LIMIT_BUFFER_PERCENT=0.9
FUSION_PARALLEL_PREPROCESSING=true

# ============================================================================
# SAFETY AND SECURITY CONFIGURATION
# ============================================================================

# LLM Structural Cypher Safety Settings (PRODUCTION CRITICAL)
LLM_CYPHER_ALLOW_CALL=false
LLM_CYPHER_MAX_HOPS=3
LLM_CYPHER_FORCE_LIMIT=50
USE_LLM_STRUCTURAL_CYPHER=true
LLM_CYPHER_EXAMPLES_ENABLED=true
LLM_CYPHER_PROMPT_TOKEN_BUDGET=4500

# LLM Structural Narrative Settings
LLM_STRUCTURAL_NARRATIVE_ENABLED=true
LLM_STRUCTURAL_NARRATIVE_TOKEN_BUDGET=3500
LLM_STRUCTURAL_SOURCE_MAX=10
LLM_STRUCTURAL_PRESERVE_NUMBERS=true
LLM_STRUCTURAL_CITATION_VALIDATION=true

# Domain Citation Settings
LLM_DOMAIN_CITATION_ENABLED=true

# ============================================================================
# SEARCH ENGINE CONFIGURATION
# ============================================================================

# Semantic Search Engine Settings
# NOTE: Schema-aware semantic search is enabled by default in code.
# Set to false here only if you want to disable it explicitly.
SEMANTIC_USE_STRUCTURAL_SCHEMA=true
SEMANTIC_SCHEMA_TOKEN_BUDGET=2500
SEMANTIC_SCHEMA_MAX_ITEMS=15

# Citation and Domain Enforcement
SEMANTIC_CITATION_VALIDATION=true
SEMANTIC_DOMAIN_ENFORCEMENT=true
SEMANTIC_DOMAIN_MARKERS_PER_REF=2

# ============================================================================
# CONFIDENCE SCORING CONFIGURATION
# ============================================================================

# Confidence Caps (0.0 to 1.0)
SEMANTIC_CONFIDENCE_CAP=1.0
TRAVERSAL_CONFIDENCE_CAP=1.0
FUSION_CONFIDENCE_CAP=1.0

# ============================================================================
# CIRCUIT BREAKER CONFIGURATION
# ============================================================================


# ============================================================================
# SCHEMA CONFIGURATION
# ============================================================================

SCHEMA_EXPORT_ENABLED=true
SCHEMA_EXPORT_FILENAME=kg_schema_structural_summary.json

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================


# ============================================================================
# DEVELOPMENT NOTES
# ============================================================================
# 
# Production Deployment:
# - Set APP_ENV=production
# - Ensure LLM_CYPHER_ALLOW_CALL=false (enforced automatically)
# - Use strong passwords and secure API keys
# - Consider reducing LOG_LEVEL=INFO or WARNING
# - Verify confidence caps are appropriate for your use case
#
# Development Setup:
# - Keep APP_ENV=development for safe defaults
# - Set VERBOSE=true for detailed logging
# - Use separate Neo4j instances for dev/prod
#
# Testing:
# - Set FORCE_TEST_DB=true to use test database explicitly
# - This overrides APP_ENV for safety during testing
